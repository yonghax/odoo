<?xml version="1.0" encoding="utf-8"?>
<odoo>

        <!-- Expenses -->

        <record id="view_expenses_tree_group_button" model="ir.ui.view">
            <field name="name">hr.expense.tree.group_button</field>
            <field name="model">hr.expense</field>
            <field name="inherit_id" ref="hr_expense.view_expenses_tree"/>
            <field name="arch" type="xml">
                <button name="approve_expenses" position="attributes">
                	<attribute name="groups">hr_advance.group_approve_expense</attribute>
                </button>
                <button name="%(hr_expense.hr_expense_refuse_wizard_action)d" position="attributes">
                	<attribute name="groups">hr_advance.group_approve_expense</attribute>
                </button>
            </field>
        </record>

        <record id="hr_expense_my_tree_group_button" model="ir.ui.view">
            <field name="name">my.hr.expense.tree.group_button</field>
            <field name="model">hr.expense</field>
            <field name="inherit_id" ref="hr_expense.hr_expense_my_tree"/>
            <field name="arch" type="xml">
                <button name="approve_expenses" position="attributes">
                	<attribute name="groups">hr_advance.group_approve_expense</attribute>
                </button>
                <button name="%(hr_expense.hr_expense_refuse_wizard_action)d" position="attributes">
                	<attribute name="groups">hr_advance.group_approve_expense</attribute>
                </button>
            </field>
        </record>

        <record id="hr_expense_form_view_group_button" model="ir.ui.view">
            <field name="name">hr.expense.form.group_button</field>
            <field name="model">hr.expense</field>
	        <field name="inherit_id" ref="hr_expense.hr_expense_form_view"/>
            <field name="arch" type="xml">
            	<button name="approve_expenses" position="attributes">
            		<attribute name="groups">hr_advance.group_approve_expense</attribute>
            	</button>
            	<xpath expr="//button[3]" position="attributes">
            		<attribute name="groups">hr_advance.group_approve_expense</attribute>
            	</xpath>
            </field>
        </record>

    <record id="view_hr_expense_filter" model="ir.ui.view">
        <field name="name">hr.expense.filter</field>
        <field name="model">hr.expense</field>
        <field name="inherit_id" ref="hr_expense.view_hr_expense_filter"/>
        <field name="arch" type="xml">
            <xpath expr="//filter[4]" position="attributes">
            	<attribute name="domain">
            		['|', ('employee_id.parent_id.user_id', '=', uid),
            		'|', ('employee_id.department_id.manager_id.user_id', '=', uid),
            		('employee_id.department_id.manager_id.parent_id.user_id', '=', uid)]
            	</attribute>
            	<attribute name="groups">hr_advance.group_approve_expense</attribute>
            </xpath>
        </field>
    </record>

    <delete id="hr_expense.hr_expense_entry_action_server" model="ir.actions.server"/>

    <record id="hr_expense.action_hr_expense_account_entry" model="ir.values">
        <field name="name">action_hr_expense_account_entry</field>
        <field name="action_id" ref="hr_expense_post_wizard_action" />
        <field name="value" eval="'ir.actions.act_window,' + str(ref('hr_expense_post_wizard_action'))" />
        <field name="key">action</field>
        <field name="model_id" ref="model_hr_expense"/>
        <field name="model">hr.expense</field>
        <field name="key2">client_action_multi</field>
    </record>

    <record model="ir.ui.menu" id="hr_expense.menu_expense_all">
    	<field name="sequence">1</field>
        <field ref="menu_hr_expense_all_sub" name="parent_id"/>
    </record>
    <record model="ir.ui.menu" id="hr_expense.menu_expense_to_approve">
    	<field name="name">Expenses To Approve</field>
    	<field name="sequence">1</field>
        <field ref="menu_expense_to_approve_sub" name="parent_id"/>
        <field name="groups_id" eval="[(4, ref('hr_advance.group_approve_expense'))]"/>
    </record>

    <record model="ir.ui.menu" id="hr_expense.menu_hr_expense">
    	<field name="name">Expenses</field>
    	<field name="sequence">1</field>
        <field ref="menu_hr_expense_sub" name="parent_id"/>
    </record>

</odoo>
